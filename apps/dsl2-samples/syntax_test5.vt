
future<event> dma;
future<float> facq;

async float acq(float y, chan<spi0> z){
    int x;

    x = y * 2;
    //start data acquisition 

    HAL_start(z);

    return x;
}

void irq(){
    signal dma;
}

async void main(chan<spi0> y){
    float res;

    facq = acq(3.0);
    while(1){
        res = await facq;
        facq = acq(3.0, y);
        //processing the res while the next acq is happening
     }
}
