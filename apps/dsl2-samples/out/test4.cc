/********************************************************************************
This code is automatically generated by the VerticalThings compiler. DO NOT EDIT!
********************************************************************************/

struct _arec_event {volatile int _state;};
#define NULL ((void *)0UL)
struct _arec__test4_acq;
typedef void (*_t__test4_acq) (struct _arec__test4_acq* _this, float*  _ret0);
struct _arec__test4_acq{
    int _state = 0;
    float test4_acq_y;
    int test4_acq_x;
};
struct _arec__test4_irq;
typedef void (*_t__test4_irq) ();
struct _arec__test4_main;
typedef void (*_t__test4_main) (struct _arec__test4_main* _this, void*  _ret0);
struct _arec__test4_main{
    int _state = 0;
    float test4_main_res;
    struct _arec__test4_acq _arec__test4_acq;
};
/*Module vars for test4*/
struct _arec_event*  test4_dma;
struct _arec__test4_acq*  test4_facq;
/*End of module vars for test4*/
int _test4_acq(struct _arec__test4_acq* _this, float*  _ret0)
{
static const void * _atbl[] = { &&lstate_0, &&lstate_1, &&lstate_2 };
int _state = _this->_state;
_this->_state = 0;
if (_state > 0 && _state < 2) goto *(_atbl[_state]);
lstate_0:
{
    _this->test4_acq_x=(_this->test4_acq_y*2);
    test4_dma->_state = 1;
    lstate_1:
    _state = test4_dma->_state;
    if (_state > 0) {_this->_state = 1; return _this->_state;} 
    lstate_2:
    if (_ret0 == NULL){
        _this->_state = 2;
    }
    else{
        *(_ret0) = _this->test4_acq_x;
    }
    return _this->_state; 
}
return _this->_state;
}
void _test4_irq()
{
    {
        test4_dma->_state = 0;
    }
}
int _test4_main(struct _arec__test4_main* _this)
{
static const void * _atbl[] = { &&lstate_0, &&lstate_1 };
int _state = _this->_state;
_this->_state = 0;
if (_state > 0 && _state < 1) goto *(_atbl[_state]);
lstate_0:
{
    while(1)
    {
        _this->_arec__test4_acq._state = 0;
        _this->_arec__test4_acq.test4_acq_y = 3;
        _test4_acq( &(_this->_arec__test4_acq), ((float*) 0UL)) ;
        test4_facq= &(_this->_arec__test4_acq);
        lstate_1:
        _state = _test4_acq(test4_facq, (&_this->test4_main_res) );
        if (_state > 0) {_this->_state = 1; return _this->_state;} 
    }
}
return _this->_state;
}